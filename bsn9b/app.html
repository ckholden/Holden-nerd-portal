<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sumner BSN9B Nursing Documentation</title>
    <script>
        if (sessionStorage.getItem('bsn9b_auth') !== 'true') {
            window.location.href = 'index.html';
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@7.8.2/build/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 950px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #1f4e79 0%, #2d5a87 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 { font-size: 28px; margin-bottom: 5px; }
        .header p { opacity: 0.9; font-size: 13px; }
        .form-container { padding: 30px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        .form-row.three-col { grid-template-columns: 1fr 1fr 1fr; }
        .form-group { margin-bottom: 15px; }
        label { display: block; font-weight: 600; color: #1a1a2e; margin-bottom: 6px; font-size: 13px; }
        input, select, textarea {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
            background: #fafafa;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #1f4e79;
            box-shadow: 0 0 0 3px rgba(31, 78, 121, 0.1);
            background: white;
        }
        textarea { min-height: 80px; resize: vertical; }
        textarea.large { min-height: 120px; }
        .note-type-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
        .note-type-card {
            padding: 14px 8px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        .note-type-card:hover { border-color: #1f4e79; background: #f8fafc; }
        .note-type-card.active {
            border-color: #1f4e79;
            background: #1f4e79;
            color: white;
        }
        .note-type-card h3 { font-size: 15px; margin-bottom: 3px; }
        .note-type-card p { font-size: 9px; opacity: 0.8; }
        .section-title {
            font-size: 16px;
            color: #1f4e79;
            margin: 25px 0 15px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #1f4e79;
        }
        .note-fields { display: none; }
        .note-fields.active { display: block; }
        .field-header { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .field-letter {
            width: 28px; height: 28px;
            background: #1f4e79;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 13px;
        }
        .field-info h4 { font-size: 13px; color: #1a1a2e; }
        .field-info p { font-size: 11px; color: #666; }
        .btn-container { display: flex; gap: 12px; margin-top: 25px; }
        .btn {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-pdf { background: #1f4e79; color: white; }
        .btn-word { background: #2b5797; color: white; }
        .btn-clear { background: #f0f0f0; color: #333; flex: 0.4; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(0,0,0,0.15); }
        .warning-box {
            background: #fff5f5;
            border: 1px solid #e53e3e;
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 15px;
            font-size: 12px;
            color: #c53030;
        }
        .info-box {
            background: #fffbeb;
            border: 1px solid #d69e2e;
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 15px;
            font-size: 12px;
        }
        .info-box ul { margin: 8px 0 0 18px; }
        .info-box li { margin-bottom: 3px; }
        /* NANDA Search */
        .nanda-section { margin: 20px 0; padding: 15px; background: #f8fafc; border-radius: 10px; border: 1px solid #e2e8f0; }
        .nanda-search { position: relative; }
        .nanda-search input { padding-right: 35px; }
        .nanda-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 250px;
            overflow-y: auto;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 100;
            display: none;
        }
        .nanda-dropdown.show { display: block; }
        .nanda-item {
            padding: 10px 12px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            font-size: 13px;
        }
        .nanda-item:hover { background: #f0f7ff; }
        .nanda-item .category { font-size: 10px; color: #1f4e79; font-weight: 600; }
        .selected-diagnoses { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .diagnosis-tag {
            background: #1f4e79;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .diagnosis-tag .remove { cursor: pointer; opacity: 0.8; }
        .diagnosis-tag .remove:hover { opacity: 1; }
        /* H2T Assessment */
        .h2t-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .h2t-section { background: #f8fafc; padding: 12px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .h2t-section h4 { font-size: 13px; color: #1f4e79; margin-bottom: 8px; border-bottom: 1px solid #e2e8f0; padding-bottom: 5px; }
        .quick-fills { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 8px; }
        .quick-fill {
            background: #e8f4fd;
            border: 1px solid #bee3f8;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .quick-fill:hover { background: #1f4e79; color: white; border-color: #1f4e79; }
        .h2t-section textarea { min-height: 60px; font-size: 12px; }
        @media (max-width: 768px) {
            .note-type-grid { grid-template-columns: repeat(2, 1fr); }
            .form-row, .form-row.three-col, .h2t-grid { grid-template-columns: 1fr; }
            .btn-container { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Sumner BSN9B Nursing Documentation</h1>
            <p>Progress Notes | Head-to-Toe | NANDA Diagnoses</p>
            <p style="margin-top: 10px; font-size: 12px;"><a href="mailto:christiankholden@gmail.com?subject=BSN9B%20Nursing%20Documentation%20Feedback" style="color: #a8d4ff; text-decoration: none;">Issues or Suggestions? Email Us</a></p>
        </div>
        <div class="form-container">
            <div class="warning-box">
                <strong>HIPAA Notice:</strong> Do NOT enter PHI/PII. Use patient aliases only (e.g., "J.D.", "Room 302").
            </div>
            <div class="info-box">
                <strong>Quick Start:</strong>
                <ul>
                    <li>Enter your info and patient details</li>
                    <li>Select format and complete documentation</li>
                    <li>Export to PDF or Word</li>
                </ul>
            </div>

            <h2 class="section-title">Patient & Nurse Information</h2>
            <div class="form-row">
                <div class="form-group">
                    <label>Nurse Name</label>
                    <input type="text" id="nurseName" placeholder="Enter your name">
                </div>
                <div class="form-group">
                    <label>Credentials</label>
                    <select id="credentials">
                        <option value="Student RN">Student RN</option>
                        <option value="RN">RN</option>
                        <option value="BSN, RN">BSN, RN</option>
                        <option value="LPN">LPN</option>
                    </select>
                </div>
            </div>
            <div class="form-row three-col">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="noteDate">
                </div>
                <div class="form-group">
                    <label>Time</label>
                    <input type="time" id="noteTime">
                </div>
                <div class="form-group">
                    <label>Unit</label>
                    <input type="text" id="unit" placeholder="e.g., Med-Surg 3B">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Patient ID</label>
                    <input type="text" id="patientId" placeholder="e.g., J.D. / Room 302">
                </div>
                <div class="form-group">
                    <label>Demographics</label>
                    <input type="text" id="patientDemo" placeholder="e.g., 42yom">
                </div>
            </div>

            <h2 class="section-title">Documentation Format</h2>
            <div class="note-type-grid">
                <div class="note-type-card active" onclick="selectNoteType('dar')">
                    <h3>DAR</h3>
                    <p>Data, Action, Response</p>
                </div>
                <div class="note-type-card" onclick="selectNoteType('darp')">
                    <h3>DARP</h3>
                    <p>DAR + Plan</p>
                </div>
                <div class="note-type-card" onclick="selectNoteType('soap')">
                    <h3>SOAP</h3>
                    <p>Subj, Obj, Assess, Plan</p>
                </div>
                <div class="note-type-card" onclick="selectNoteType('sbar')">
                    <h3>SBAR</h3>
                    <p>Situation, Background</p>
                </div>
                <div class="note-type-card" onclick="selectNoteType('pie')">
                    <h3>PIE</h3>
                    <p>Problem, Intervention</p>
                </div>
                <div class="note-type-card" onclick="selectNoteType('h2t')">
                    <h3>H2T</h3>
                    <p>Head-to-Toe Assessment</p>
                </div>
                <div class="note-type-card" onclick="selectNoteType('soapie')">
                    <h3>SOAPIE</h3>
                    <p>SOAP + I, E</p>
                </div>
                <div class="note-type-card" onclick="selectNoteType('narrative')">
                    <h3>Narrative</h3>
                    <p>Free-form Note</p>
                </div>
            </div>

            <!-- NANDA Diagnosis Section -->
            <div class="nanda-section">
                <label>NANDA Nursing Diagnoses (optional - search to add)</label>
                <div class="nanda-search">
                    <input type="text" id="nandaSearch" placeholder="Search diagnoses... (e.g., pain, anxiety, mobility)" oninput="searchNanda()" onfocus="searchNanda()">
                    <div class="nanda-dropdown" id="nandaDropdown"></div>
                </div>
                <div class="selected-diagnoses" id="selectedDiagnoses"></div>
            </div>

            <h2 class="section-title">Documentation</h2>

            <div class="form-group" id="focusGroup">
                <label>FOCUS</label>
                <input type="text" id="focus" placeholder="e.g., Pain management, Fall risk, Post-op care">
            </div>

            <!-- DAR -->
            <div id="darFields" class="note-fields active">
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">D</span><div class="field-info"><h4>Data</h4></div></div>
                    <textarea id="darData" class="large" placeholder="Subjective & objective data..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">A</span><div class="field-info"><h4>Action</h4></div></div>
                    <textarea id="darAction" class="large" placeholder="Nursing interventions..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">R</span><div class="field-info"><h4>Response</h4></div></div>
                    <textarea id="darResponse" placeholder="Patient response..."></textarea>
                </div>
            </div>

            <!-- DARP -->
            <div id="darpFields" class="note-fields">
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">D</span><div class="field-info"><h4>Data</h4></div></div>
                    <textarea id="darpData" class="large" placeholder="Subjective & objective data..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">A</span><div class="field-info"><h4>Action</h4></div></div>
                    <textarea id="darpAction" placeholder="Nursing interventions..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">R</span><div class="field-info"><h4>Response</h4></div></div>
                    <textarea id="darpResponse" placeholder="Patient response..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">P</span><div class="field-info"><h4>Plan</h4></div></div>
                    <textarea id="darpPlan" placeholder="Care plan..."></textarea>
                </div>
            </div>

            <!-- SOAP -->
            <div id="soapFields" class="note-fields">
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">S</span><div class="field-info"><h4>Subjective</h4></div></div>
                    <textarea id="soapSubjective" class="large" placeholder="Patient statements..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">O</span><div class="field-info"><h4>Objective</h4></div></div>
                    <textarea id="soapObjective" class="large" placeholder="Vital signs, observations..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">A</span><div class="field-info"><h4>Assessment</h4></div></div>
                    <textarea id="soapAssessment" placeholder="Nursing diagnosis..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">P</span><div class="field-info"><h4>Plan</h4></div></div>
                    <textarea id="soapPlan" placeholder="Care plan..."></textarea>
                </div>
            </div>

            <!-- SOAPIE -->
            <div id="soapieFields" class="note-fields">
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">S</span><div class="field-info"><h4>Subjective</h4></div></div>
                    <textarea id="soapieSubjective" placeholder="Patient statements..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">O</span><div class="field-info"><h4>Objective</h4></div></div>
                    <textarea id="soapieObjective" placeholder="VS, observations..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">A</span><div class="field-info"><h4>Assessment</h4></div></div>
                    <textarea id="soapieAssessment" placeholder="Nursing diagnosis..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">P</span><div class="field-info"><h4>Plan</h4></div></div>
                    <textarea id="soapiePlan" placeholder="Care plan..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">I</span><div class="field-info"><h4>Intervention</h4></div></div>
                    <textarea id="soapieIntervention" placeholder="Actions taken..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">E</span><div class="field-info"><h4>Evaluation</h4></div></div>
                    <textarea id="soapieEvaluation" placeholder="Effectiveness..."></textarea>
                </div>
            </div>

            <!-- SBAR -->
            <div id="sbarFields" class="note-fields">
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">S</span><div class="field-info"><h4>Situation</h4></div></div>
                    <textarea id="sbarSituation" class="large" placeholder="What is happening now?"></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">B</span><div class="field-info"><h4>Background</h4></div></div>
                    <textarea id="sbarBackground" class="large" placeholder="Relevant history..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">A</span><div class="field-info"><h4>Assessment</h4></div></div>
                    <textarea id="sbarAssessment" placeholder="What do you think is the problem?"></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">R</span><div class="field-info"><h4>Recommendation</h4></div></div>
                    <textarea id="sbarRecommendation" placeholder="What do you need?"></textarea>
                </div>
            </div>

            <!-- PIE -->
            <div id="pieFields" class="note-fields">
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">P</span><div class="field-info"><h4>Problem</h4></div></div>
                    <textarea id="pieProblem" class="large" placeholder="Nursing diagnosis or problem..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">I</span><div class="field-info"><h4>Intervention</h4></div></div>
                    <textarea id="pieIntervention" class="large" placeholder="Actions taken..."></textarea>
                </div>
                <div class="form-group">
                    <div class="field-header"><span class="field-letter">E</span><div class="field-info"><h4>Evaluation</h4></div></div>
                    <textarea id="pieEvaluation" placeholder="Effectiveness, outcomes..."></textarea>
                </div>
            </div>

            <!-- Narrative -->
            <div id="narrativeFields" class="note-fields">
                <div class="form-group">
                    <label>Narrative Note</label>
                    <textarea id="narrativeText" class="large" style="min-height:200px" placeholder="Document in free-form narrative format..."></textarea>
                </div>
            </div>

            <!-- Head-to-Toe Assessment -->
            <div id="h2tFields" class="note-fields">
                <p style="font-size:12px;color:#666;margin-bottom:15px;">Click quick-fill buttons to insert common findings, then edit as needed.</p>
                <div class="h2t-grid">
                    <div class="h2t-section">
                        <h4>Neurological</h4>
                        <div class="quick-fills">
                            <span class="quick-fill" onclick="appendToField('h2tNeuro', 'A&O x4. ')">A&O x4</span>
                            <span class="quick-fill" onclick="appendToField('h2tNeuro', 'PERRLA 3mm. ')">PERRLA</span>
                            <span class="quick-fill" onclick="appendToField('h2tNeuro', 'GCS 15. ')">GCS 15</span>
                            <span class="quick-fill" onclick="appendToField('h2tNeuro', 'MAE x4, strength 5/5. ')">MAE</span>
                            <span class="quick-fill" onclick="appendToField('h2tNeuro', 'No focal deficits. ')">No deficits</span>
                        </div>
                        <textarea id="h2tNeuro" placeholder="LOC, orientation, pupils, motor/sensory..."></textarea>
                    </div>
                    <div class="h2t-section">
                        <h4>Cardiovascular</h4>
                        <div class="quick-fills">
                            <span class="quick-fill" onclick="appendToField('h2tCardio', 'S1S2, RRR, no murmur. ')">S1S2 RRR</span>
                            <span class="quick-fill" onclick="appendToField('h2tCardio', 'Radial pulses 2+ bilat. ')">Pulses 2+</span>
                            <span class="quick-fill" onclick="appendToField('h2tCardio', 'Cap refill <3 sec. ')">Cap refill <3s</span>
                            <span class="quick-fill" onclick="appendToField('h2tCardio', 'No peripheral edema. ')">No edema</span>
                            <span class="quick-fill" onclick="appendToField('h2tCardio', 'Pedal pulses palpable bilat. ')">Pedal pulses</span>
                        </div>
                        <textarea id="h2tCardio" placeholder="Heart sounds, pulses, edema, cap refill..."></textarea>
                    </div>
                    <div class="h2t-section">
                        <h4>Respiratory</h4>
                        <div class="quick-fills">
                            <span class="quick-fill" onclick="appendToField('h2tResp', 'CTA bilat. ')">CTA bilat</span>
                            <span class="quick-fill" onclick="appendToField('h2tResp', 'Unlabored, regular. ')">Unlabored</span>
                            <span class="quick-fill" onclick="appendToField('h2tResp', 'RA, SpO2 WNL. ')">RA</span>
                            <span class="quick-fill" onclick="appendToField('h2tResp', 'O2 via NC _L/min. ')">O2 NC</span>
                            <span class="quick-fill" onclick="appendToField('h2tResp', 'No cough, no SOB. ')">No cough/SOB</span>
                        </div>
                        <textarea id="h2tResp" placeholder="Breath sounds, effort, O2, cough..."></textarea>
                    </div>
                    <div class="h2t-section">
                        <h4>Gastrointestinal</h4>
                        <div class="quick-fills">
                            <span class="quick-fill" onclick="appendToField('h2tGI', 'BS active x4 quads. ')">BS active</span>
                            <span class="quick-fill" onclick="appendToField('h2tGI', 'Soft, non-tender, non-distended. ')">Soft NT ND</span>
                            <span class="quick-fill" onclick="appendToField('h2tGI', 'Last BM: ___. ')">Last BM</span>
                            <span class="quick-fill" onclick="appendToField('h2tGI', 'Tolerating diet. ')">Tolerating diet</span>
                            <span class="quick-fill" onclick="appendToField('h2tGI', 'No N/V. ')">No N/V</span>
                        </div>
                        <textarea id="h2tGI" placeholder="Bowel sounds, abdomen, N/V, diet, BM..."></textarea>
                    </div>
                    <div class="h2t-section">
                        <h4>Genitourinary</h4>
                        <div class="quick-fills">
                            <span class="quick-fill" onclick="appendToField('h2tGU', 'Voiding without difficulty. ')">Voiding WNL</span>
                            <span class="quick-fill" onclick="appendToField('h2tGU', 'Foley patent, clear yellow urine. ')">Foley patent</span>
                            <span class="quick-fill" onclick="appendToField('h2tGU', 'Last void: ___. ')">Last void</span>
                            <span class="quick-fill" onclick="appendToField('h2tGU', 'I&O balanced. ')">I&O balanced</span>
                        </div>
                        <textarea id="h2tGU" placeholder="Voiding, Foley, output, color..."></textarea>
                    </div>
                    <div class="h2t-section">
                        <h4>Skin/Integumentary</h4>
                        <div class="quick-fills">
                            <span class="quick-fill" onclick="appendToField('h2tSkin', 'Warm, dry, intact. ')">WDI</span>
                            <span class="quick-fill" onclick="appendToField('h2tSkin', 'Color appropriate. ')">Color WNL</span>
                            <span class="quick-fill" onclick="appendToField('h2tSkin', 'Turgor elastic. ')">Turgor elastic</span>
                            <span class="quick-fill" onclick="appendToField('h2tSkin', 'No breakdown, no pressure areas. ')">No breakdown</span>
                            <span class="quick-fill" onclick="appendToField('h2tSkin', 'IV site: ___. ')">IV site</span>
                        </div>
                        <textarea id="h2tSkin" placeholder="Color, temp, turgor, wounds, IV sites..."></textarea>
                    </div>
                    <div class="h2t-section">
                        <h4>Musculoskeletal</h4>
                        <div class="quick-fills">
                            <span class="quick-fill" onclick="appendToField('h2tMSK', 'ROM intact. ')">ROM intact</span>
                            <span class="quick-fill" onclick="appendToField('h2tMSK', 'Gait steady. ')">Gait steady</span>
                            <span class="quick-fill" onclick="appendToField('h2tMSK', 'Ambulating independently. ')">Ambulating</span>
                            <span class="quick-fill" onclick="appendToField('h2tMSK', 'Bed rest. ')">Bed rest</span>
                            <span class="quick-fill" onclick="appendToField('h2tMSK', 'Fall risk precautions. ')">Fall risk</span>
                        </div>
                        <textarea id="h2tMSK" placeholder="Mobility, ROM, strength, gait, fall risk..."></textarea>
                    </div>
                    <div class="h2t-section">
                        <h4>Pain/Comfort</h4>
                        <div class="quick-fills">
                            <span class="quick-fill" onclick="appendToField('h2tPain', 'Pain 0/10. ')">Pain 0/10</span>
                            <span class="quick-fill" onclick="appendToField('h2tPain', 'Pain ___/10 at ___. ')">Pain __/10</span>
                            <span class="quick-fill" onclick="appendToField('h2tPain', 'Denies pain. ')">Denies pain</span>
                            <span class="quick-fill" onclick="appendToField('h2tPain', 'Medicated for pain. ')">Medicated</span>
                        </div>
                        <textarea id="h2tPain" placeholder="Pain level, location, quality, interventions..."></textarea>
                    </div>
                </div>
                <div class="form-group" style="margin-top:15px;">
                    <label>Psychosocial/Additional Notes</label>
                    <textarea id="h2tPsych" placeholder="Mood, behavior, support system, safety concerns, plan..."></textarea>
                </div>
            </div>

            <div class="btn-container">
                <button class="btn btn-clear" onclick="clearForm()">Clear</button>
                <button class="btn btn-word" onclick="generateWord()">Export Word</button>
                <button class="btn btn-pdf" onclick="generatePDF()">Export PDF</button>
            </div>
        </div>
    </div>

    <script>
        const { jsPDF } = window.jspdf;
        let currentNoteType = 'dar';
        let selectedDiagnoses = [];

        // NANDA Database
        const nandaDatabase = [
            // Activity/Rest
            {name: "Activity intolerance", category: "Activity/Rest", def: "Insufficient physiological or psychological energy to endure or complete daily activities"},
            {name: "Activity intolerance, risk for", category: "Activity/Rest", def: "At risk for insufficient energy to complete daily activities"},
            {name: "Fatigue", category: "Activity/Rest", def: "Overwhelming sustained sense of exhaustion and decreased capacity for work"},
            {name: "Insomnia", category: "Activity/Rest", def: "Disruption in amount and quality of sleep that impairs functioning"},
            {name: "Mobility: physical, impaired", category: "Activity/Rest", def: "Limitation in independent, purposeful physical movement"},
            {name: "Mobility: bed, impaired", category: "Activity/Rest", def: "Limitation of independent movement from one bed position to another"},
            {name: "Sleep deprivation", category: "Activity/Rest", def: "Prolonged periods without sleep"},
            {name: "Sleep pattern disturbed", category: "Activity/Rest", def: "Time-limited interruptions of sleep amount and quality"},
            {name: "Walking, impaired", category: "Activity/Rest", def: "Limitation of independent movement within environment on foot"},
            // Circulation
            {name: "Bleeding, risk for", category: "Circulation", def: "At risk for decrease in blood volume that may compromise health"},
            {name: "Cardiac output, decreased", category: "Circulation", def: "Inadequate blood pumped by heart to meet metabolic demands"},
            {name: "Tissue perfusion, ineffective peripheral", category: "Circulation", def: "Decrease in blood circulation to peripheries that may compromise health"},
            {name: "Tissue perfusion, ineffective cerebral, risk for", category: "Circulation", def: "Risk for decrease in cerebral tissue circulation"},
            {name: "Shock, risk for", category: "Circulation", def: "At risk for inadequate blood flow to body tissues"},
            // Ego Integrity
            {name: "Anxiety", category: "Ego Integrity", def: "Vague uneasy feeling of discomfort or dread with autonomic response"},
            {name: "Anxiety, death", category: "Ego Integrity", def: "Vague uneasy feeling generated by perceptions of threat to existence"},
            {name: "Body image, disturbed", category: "Ego Integrity", def: "Confusion in mental picture of one's physical self"},
            {name: "Coping, ineffective", category: "Ego Integrity", def: "Inability to form valid appraisal of stressors or access resources"},
            {name: "Fear", category: "Ego Integrity", def: "Response to perceived threat consciously recognized as danger"},
            {name: "Grieving", category: "Ego Integrity", def: "Normal complex process incorporating actual or anticipated loss"},
            {name: "Grieving, complicated", category: "Ego Integrity", def: "Disorder where bereavement distress manifests in functional impairment"},
            {name: "Hopelessness", category: "Ego Integrity", def: "State where individual sees limited alternatives and unable to mobilize energy"},
            {name: "Powerlessness", category: "Ego Integrity", def: "Perception that one's actions will not significantly affect outcome"},
            {name: "Self-esteem, chronic low", category: "Ego Integrity", def: "Long-standing negative self-evaluation/feelings about self"},
            {name: "Self-esteem, situational low", category: "Ego Integrity", def: "Development of negative perception of self-worth in response to situation"},
            // Elimination
            {name: "Bowel incontinence", category: "Elimination", def: "Change in bowel habits characterized by involuntary passage of stool"},
            {name: "Constipation", category: "Elimination", def: "Decrease in frequency of defecation with difficult or incomplete passage"},
            {name: "Constipation, risk for", category: "Elimination", def: "At risk for decrease in normal frequency of defecation"},
            {name: "Diarrhea", category: "Elimination", def: "Passage of loose, unformed stools"},
            {name: "Urinary elimination, impaired", category: "Elimination", def: "Disturbance in urine elimination"},
            {name: "Urinary incontinence, functional", category: "Elimination", def: "Inability to reach toilet in time to avoid unintentional loss of urine"},
            {name: "Urinary incontinence, stress", category: "Elimination", def: "Sudden leakage with activities that increase intra-abdominal pressure"},
            {name: "Urinary incontinence, urge", category: "Elimination", def: "Involuntary passage soon after strong sense of urgency"},
            {name: "Urinary retention", category: "Elimination", def: "Incomplete emptying of the bladder"},
            // Food/Fluid
            {name: "Fluid volume, deficient", category: "Food/Fluid", def: "Decreased intravascular, interstitial and/or intracellular fluid"},
            {name: "Fluid volume, deficient, risk for", category: "Food/Fluid", def: "At risk for vascular, cellular, or intracellular dehydration"},
            {name: "Fluid volume, excess", category: "Food/Fluid", def: "Increased isotonic fluid retention"},
            {name: "Electrolyte imbalance, risk for", category: "Food/Fluid", def: "At risk for change in serum electrolyte levels"},
            {name: "Nutrition: imbalanced, less than body requirements", category: "Food/Fluid", def: "Intake of nutrients insufficient to meet metabolic needs"},
            {name: "Nutrition: imbalanced, more than body requirements", category: "Food/Fluid", def: "Intake of nutrients that exceeds metabolic needs"},
            {name: "Nausea", category: "Food/Fluid", def: "Subjective unpleasant wave-like sensation that may lead to vomiting"},
            {name: "Swallowing, impaired", category: "Food/Fluid", def: "Abnormal functioning of swallowing mechanism"},
            // Neurosensory
            {name: "Confusion, acute", category: "Neurosensory", def: "Abrupt onset of reversible disturbances of consciousness and cognition"},
            {name: "Confusion, chronic", category: "Neurosensory", def: "Irreversible progressive deterioration of intellect and personality"},
            {name: "Communication, impaired verbal", category: "Neurosensory", def: "Decreased ability to receive, process, transmit, and use symbols"},
            {name: "Memory, impaired", category: "Neurosensory", def: "Inability to remember or recall bits of information"},
            {name: "Sensory perception, disturbed", category: "Neurosensory", def: "Change in amount or patterning of incoming stimuli"},
            // Pain/Discomfort
            {name: "Pain, acute", category: "Pain/Discomfort", def: "Unpleasant sensory experience from actual or potential tissue damage, <6 months"},
            {name: "Pain, chronic", category: "Pain/Discomfort", def: "Unpleasant sensory experience without predictable end, >6 months"},
            {name: "Comfort, impaired", category: "Pain/Discomfort", def: "Perceived lack of ease, relief in physical/psychospiritual dimensions"},
            // Respiration
            {name: "Airway clearance, ineffective", category: "Respiration", def: "Inability to clear secretions or obstructions from respiratory tract"},
            {name: "Aspiration, risk for", category: "Respiration", def: "At risk for entry of secretions into tracheobronchial passages"},
            {name: "Breathing pattern, ineffective", category: "Respiration", def: "Inspiration/expiration that does not provide adequate ventilation"},
            {name: "Gas exchange, impaired", category: "Respiration", def: "Excess or deficit in oxygenation at alveolar-capillary membrane"},
            // Safety
            {name: "Falls, risk for", category: "Safety", def: "Increased susceptibility to falling that may cause physical harm"},
            {name: "Infection, risk for", category: "Safety", def: "At increased risk for being invaded by pathogenic organisms"},
            {name: "Injury, risk for", category: "Safety", def: "At risk of injury from environmental conditions"},
            {name: "Skin integrity, impaired", category: "Safety", def: "Altered epidermis and/or dermis"},
            {name: "Skin integrity, impaired, risk for", category: "Safety", def: "At risk for skin being adversely altered"},
            {name: "Hypothermia", category: "Safety", def: "Body temperature below normal range"},
            {name: "Hyperthermia", category: "Safety", def: "Body temperature elevated above normal range"},
            {name: "Trauma, risk for", category: "Safety", def: "Accentuated risk of accidental tissue injury"},
            // Hygiene
            {name: "Self-care deficit, bathing", category: "Hygiene", def: "Impaired ability to perform bathing activities"},
            {name: "Self-care deficit, dressing", category: "Hygiene", def: "Impaired ability to perform dressing activities"},
            {name: "Self-care deficit, feeding", category: "Hygiene", def: "Impaired ability to perform feeding activities"},
            {name: "Self-care deficit, toileting", category: "Hygiene", def: "Impaired ability to perform toileting activities"},
            // Knowledge
            {name: "Knowledge deficient", category: "Health Promotion", def: "Absence of cognitive information related to specific topic"},
            {name: "Noncompliance", category: "Health Promotion", def: "Behavior that fails to coincide with therapeutic plan"}
        ];

        // Initialize
        document.getElementById('noteDate').valueAsDate = new Date();
        document.getElementById('noteTime').value = new Date().toTimeString().slice(0, 5);

        function selectNoteType(type) {
            currentNoteType = type;
            document.querySelectorAll('.note-type-card').forEach(c => c.classList.remove('active'));
            event.target.closest('.note-type-card').classList.add('active');
            document.querySelectorAll('.note-fields').forEach(f => f.classList.remove('active'));
            document.getElementById(type + 'Fields').classList.add('active');
            document.getElementById('focusGroup').style.display = ['dar', 'darp'].includes(type) ? 'block' : 'none';
        }

        function searchNanda() {
            const query = document.getElementById('nandaSearch').value.toLowerCase();
            const dropdown = document.getElementById('nandaDropdown');
            if (query.length < 2) { dropdown.classList.remove('show'); return; }
            const results = nandaDatabase.filter(d =>
                d.name.toLowerCase().includes(query) ||
                d.category.toLowerCase().includes(query) ||
                d.def.toLowerCase().includes(query)
            ).slice(0, 10);
            if (results.length === 0) { dropdown.classList.remove('show'); return; }
            dropdown.innerHTML = results.map(d =>
                `<div class="nanda-item" onclick="addDiagnosis('${d.name.replace(/'/g, "\\'")}')">
                    <div class="category">${d.category}</div>
                    <div>${d.name}</div>
                </div>`
            ).join('');
            dropdown.classList.add('show');
        }

        function addDiagnosis(name) {
            if (!selectedDiagnoses.includes(name)) {
                selectedDiagnoses.push(name);
                renderDiagnoses();
            }
            document.getElementById('nandaSearch').value = '';
            document.getElementById('nandaDropdown').classList.remove('show');
        }

        function removeDiagnosis(name) {
            selectedDiagnoses = selectedDiagnoses.filter(d => d !== name);
            renderDiagnoses();
        }

        function renderDiagnoses() {
            document.getElementById('selectedDiagnoses').innerHTML = selectedDiagnoses.map(d =>
                `<div class="diagnosis-tag">${d}<span class="remove" onclick="removeDiagnosis('${d.replace(/'/g, "\\'")}')">&times;</span></div>`
            ).join('');
        }

        function appendToField(fieldId, text) {
            const field = document.getElementById(fieldId);
            field.value += text;
            field.focus();
        }

        function clearForm() {
            if (!confirm('Clear all fields?')) return;
            document.querySelectorAll('input:not([type="date"]):not([type="time"]), textarea').forEach(el => el.value = '');
            document.getElementById('noteDate').valueAsDate = new Date();
            document.getElementById('noteTime').value = new Date().toTimeString().slice(0, 5);
            selectedDiagnoses = [];
            renderDiagnoses();
        }

        function formatTime(t) { return t.replace(':', ''); }

        function getFormData() {
            return {
                nurseName: document.getElementById('nurseName').value || 'N/A',
                credentials: document.getElementById('credentials').value,
                noteDate: new Date(document.getElementById('noteDate').value + 'T00:00:00').toLocaleDateString('en-US', {month:'numeric',day:'numeric',year:'2-digit'}),
                noteTime: formatTime(document.getElementById('noteTime').value),
                unit: document.getElementById('unit').value || '',
                patientId: document.getElementById('patientId').value || 'N/A',
                patientDemo: document.getElementById('patientDemo').value || '',
                focus: document.getElementById('focus').value || ''
            };
        }

        function getNoteContent() {
            const c = [], t = currentNoteType;
            if (t === 'dar') {
                c.push({l:'D',t:'Data',x:document.getElementById('darData').value});
                c.push({l:'A',t:'Action',x:document.getElementById('darAction').value});
                c.push({l:'R',t:'Response',x:document.getElementById('darResponse').value});
            } else if (t === 'darp') {
                c.push({l:'D',t:'Data',x:document.getElementById('darpData').value});
                c.push({l:'A',t:'Action',x:document.getElementById('darpAction').value});
                c.push({l:'R',t:'Response',x:document.getElementById('darpResponse').value});
                c.push({l:'P',t:'Plan',x:document.getElementById('darpPlan').value});
            } else if (t === 'soap') {
                c.push({l:'S',t:'Subjective',x:document.getElementById('soapSubjective').value});
                c.push({l:'O',t:'Objective',x:document.getElementById('soapObjective').value});
                c.push({l:'A',t:'Assessment',x:document.getElementById('soapAssessment').value});
                c.push({l:'P',t:'Plan',x:document.getElementById('soapPlan').value});
            } else if (t === 'soapie') {
                c.push({l:'S',t:'Subjective',x:document.getElementById('soapieSubjective').value});
                c.push({l:'O',t:'Objective',x:document.getElementById('soapieObjective').value});
                c.push({l:'A',t:'Assessment',x:document.getElementById('soapieAssessment').value});
                c.push({l:'P',t:'Plan',x:document.getElementById('soapiePlan').value});
                c.push({l:'I',t:'Intervention',x:document.getElementById('soapieIntervention').value});
                c.push({l:'E',t:'Evaluation',x:document.getElementById('soapieEvaluation').value});
            } else if (t === 'sbar') {
                c.push({l:'S',t:'Situation',x:document.getElementById('sbarSituation').value});
                c.push({l:'B',t:'Background',x:document.getElementById('sbarBackground').value});
                c.push({l:'A',t:'Assessment',x:document.getElementById('sbarAssessment').value});
                c.push({l:'R',t:'Recommendation',x:document.getElementById('sbarRecommendation').value});
            } else if (t === 'pie') {
                c.push({l:'P',t:'Problem',x:document.getElementById('pieProblem').value});
                c.push({l:'I',t:'Intervention',x:document.getElementById('pieIntervention').value});
                c.push({l:'E',t:'Evaluation',x:document.getElementById('pieEvaluation').value});
            } else if (t === 'narrative') {
                c.push({l:'',t:'Narrative',x:document.getElementById('narrativeText').value});
            } else if (t === 'h2t') {
                c.push({l:'',t:'Neurological',x:document.getElementById('h2tNeuro').value});
                c.push({l:'',t:'Cardiovascular',x:document.getElementById('h2tCardio').value});
                c.push({l:'',t:'Respiratory',x:document.getElementById('h2tResp').value});
                c.push({l:'',t:'Gastrointestinal',x:document.getElementById('h2tGI').value});
                c.push({l:'',t:'Genitourinary',x:document.getElementById('h2tGU').value});
                c.push({l:'',t:'Skin/Integumentary',x:document.getElementById('h2tSkin').value});
                c.push({l:'',t:'Musculoskeletal',x:document.getElementById('h2tMSK').value});
                c.push({l:'',t:'Pain/Comfort',x:document.getElementById('h2tPain').value});
                c.push({l:'',t:'Psychosocial/Notes',x:document.getElementById('h2tPsych').value});
            }
            return c.filter(i => i.x);
        }

        function generatePDF() {
            const doc = new jsPDF();
            const pw = doc.internal.pageSize.getWidth();
            const m = 18;
            const cw = pw - m*2;
            let y = 15;
            const d = getFormData();
            const nc = getNoteContent();
            const tn = {dar:'DAR',darp:'DARP',soap:'SOAP',soapie:'SOAPIE',sbar:'SBAR',pie:'PIE',h2t:'Head-to-Toe Assessment',narrative:'Narrative Note'};

            // Header
            doc.setFillColor(31, 78, 121);
            doc.rect(0, 0, pw, 28, 'F');
            doc.setTextColor(255);
            doc.setFontSize(18);
            doc.setFont('helvetica','bold');
            doc.text('Nursing Progress Note', pw/2, 12, {align:'center'});
            doc.setFontSize(11);
            doc.setFont('helvetica','normal');
            doc.text(tn[currentNoteType], pw/2, 22, {align:'center'});

            y = 36;
            doc.setTextColor(0);

            // Info box
            doc.setFillColor(248, 250, 252);
            doc.setDrawColor(31, 78, 121);
            doc.setLineWidth(0.3);
            doc.roundedRect(m, y, cw, 24, 2, 2, 'FD');
            doc.setFontSize(9);
            y += 8;
            doc.setFont('helvetica','bold');
            doc.text('Nurse:', m+4, y);
            doc.setFont('helvetica','normal');
            doc.text(`${d.nurseName}, ${d.credentials}`, m+18, y);
            doc.setFont('helvetica','bold');
            doc.text('Date/Time:', m+85, y);
            doc.setFont('helvetica','normal');
            doc.text(`${d.noteDate} @ ${d.noteTime}`, m+108, y);
            y += 8;
            doc.setFont('helvetica','bold');
            doc.text('Patient:', m+4, y);
            doc.setFont('helvetica','normal');
            doc.text(d.patientDemo ? `${d.patientId} (${d.patientDemo})` : d.patientId, m+22, y);
            if(d.unit){doc.setFont('helvetica','bold');doc.text('Unit:',m+85,y);doc.setFont('helvetica','normal');doc.text(d.unit,m+98,y);}
            y += 14;

            // NANDA diagnoses
            if (selectedDiagnoses.length > 0) {
                doc.setFillColor(240, 249, 255);
                doc.setDrawColor(31, 78, 121);
                const dxText = 'Nursing Dx: ' + selectedDiagnoses.join('; ');
                const dxLines = doc.splitTextToSize(dxText, cw - 8);
                const dxH = 8 + dxLines.length * 4;
                doc.roundedRect(m, y, cw, dxH, 2, 2, 'FD');
                doc.setFontSize(9);
                doc.setTextColor(31, 78, 121);
                doc.setFont('helvetica','normal');
                let dy = y + 6;
                dxLines.forEach(line => { doc.text(line, m + 4, dy); dy += 4; });
                y += dxH + 4;
                doc.setTextColor(0);
            }

            // Focus
            if (['dar','darp'].includes(currentNoteType) && d.focus) {
                doc.setFillColor(31, 78, 121);
                doc.roundedRect(m, y, cw, 10, 2, 2, 'F');
                doc.setTextColor(255);
                doc.setFontSize(10);
                doc.setFont('helvetica','bold');
                doc.text('FOCUS: ' + d.focus, m + 4, y + 7);
                y += 14;
                doc.setTextColor(0);
            }

            // Content
            nc.forEach(s => {
                const lines = doc.splitTextToSize(s.x, cw - 14);
                const sh = 14 + lines.length * 4.5;
                if (y + sh > 280) { doc.addPage(); y = 15; }

                if (s.l) {
                    doc.setFillColor(31, 78, 121);
                    doc.circle(m + 6, y + 4, 5, 'F');
                    doc.setTextColor(255);
                    doc.setFontSize(10);
                    doc.setFont('helvetica','bold');
                    doc.text(s.l, m + 6, y + 6, {align:'center'});
                    doc.setTextColor(31, 78, 121);
                    doc.text(s.t, m + 14, y + 5);
                } else {
                    doc.setTextColor(31, 78, 121);
                    doc.setFontSize(10);
                    doc.setFont('helvetica','bold');
                    doc.text(s.t, m, y + 5);
                }

                y += 10;
                doc.setFont('helvetica','normal');
                doc.setFontSize(9);
                doc.setTextColor(60);
                lines.forEach(line => {
                    if (y > 280) { doc.addPage(); y = 15; }
                    doc.text(line, m + 3, y);
                    y += 4.5;
                });
                y += 5;
            });

            // Signature
            y += 8;
            if (y > 265) { doc.addPage(); y = 15; }
            doc.setDrawColor(180);
            doc.setLineWidth(0.2);
            doc.line(m, y, m + 70, y);
            doc.setFontSize(9);
            doc.setTextColor(0);
            doc.text(`${d.nurseName}, ${d.credentials}`, m, y + 6);
            doc.text(`${d.noteDate} @ ${d.noteTime}`, m, y + 11);

            // Disclaimer
            doc.setFontSize(7);
            doc.setTextColor(140);
            doc.text('*Patient demographics are simulated for educational purposes. No real patient information.', pw/2, 290, {align:'center'});

            doc.save(`${currentNoteType.toUpperCase()}_${document.getElementById('noteDate').value}_${d.noteTime}.pdf`);
        }

        async function generateWord() {
            try {
                const d = getFormData();
                const nc = getNoteContent();
                const tn = {dar:'DAR',darp:'DARP',soap:'SOAP',soapie:'SOAPIE',sbar:'SBAR',pie:'PIE',h2t:'Head-to-Toe Assessment',narrative:'Narrative Note'};
                if (typeof docx === 'undefined') { alert('Word export unavailable. Use PDF.'); return; }
                const { Document, Packer, Paragraph, TextRun, AlignmentType } = docx;
                const ch = [];
                ch.push(new Paragraph({children:[new TextRun({text:'Nursing Progress Note',bold:true,size:32,color:'1f4e79'})],alignment:AlignmentType.CENTER,spacing:{after:100}}));
                ch.push(new Paragraph({children:[new TextRun({text:tn[currentNoteType],size:22,color:'1f4e79'})],alignment:AlignmentType.CENTER,spacing:{after:200}}));
                ch.push(new Paragraph({children:[new TextRun({text:'Nurse: ',bold:true}),new TextRun(`${d.nurseName}, ${d.credentials}`),new TextRun({text:'    Date/Time: ',bold:true}),new TextRun(`${d.noteDate} @ ${d.noteTime}`)],spacing:{after:80}}));
                ch.push(new Paragraph({children:[new TextRun({text:'Patient: ',bold:true}),new TextRun(d.patientDemo?`${d.patientId} (${d.patientDemo})`:d.patientId),d.unit?new TextRun({text:'    Unit: ',bold:true}):new TextRun(''),d.unit?new TextRun(d.unit):new TextRun('')],spacing:{after:150}}));
                if(selectedDiagnoses.length>0){ch.push(new Paragraph({children:[new TextRun({text:'Nursing Dx: '+selectedDiagnoses.join('; '),color:'1f4e79'})],spacing:{after:150}}));}
                if(['dar','darp'].includes(currentNoteType)&&d.focus){ch.push(new Paragraph({children:[new TextRun({text:'FOCUS: '+d.focus,bold:true,color:'1f4e79'})],spacing:{after:150}}));}
                nc.forEach(s=>{ch.push(new Paragraph({children:[new TextRun({text:(s.l?s.l+' - ':'')+s.t,bold:true,size:22,color:'1f4e79'})],spacing:{before:150,after:80}}));ch.push(new Paragraph({children:[new TextRun(s.x)],spacing:{after:120}}));});
                ch.push(new Paragraph({text:'',spacing:{before:300}}));
                ch.push(new Paragraph({children:[new TextRun('________________________________')]}));
                ch.push(new Paragraph({children:[new TextRun(`${d.nurseName}, ${d.credentials}`)],spacing:{after:40}}));
                ch.push(new Paragraph({children:[new TextRun(`${d.noteDate} @ ${d.noteTime}`)]}));
                const doc = new Document({sections:[{children:ch}]});
                const blob = await Packer.toBlob(doc);
                saveAs(blob,`${currentNoteType.toUpperCase()}_${document.getElementById('noteDate').value}_${d.noteTime}.docx`);
            } catch(e) { console.error(e); alert('Error generating Word doc.'); }
        }

        document.addEventListener('click', e => {
            if (!e.target.closest('.nanda-search')) document.getElementById('nandaDropdown').classList.remove('show');
        });
    </script>
</body>
</html>
